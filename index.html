<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Á©øË∂äÁ≥ªÁªüÊ®°ÊãüÂô®</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link href="https://fonts.googleapis.com/css2?family=Ma+Shan+Zheng&family=Noto+Serif+SC:wght@400;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div class="container">
        <!-- Main Section -->
        <div class="section active" id="mainSection">
            <!-- Header -->
            <div class="header">
                <div class="header-icon" id="avatarIcon" title="ÁÇπÂáªÊõ¥Êç¢Â§¥ÂÉè">
                    <svg id="defaultAvatar" viewBox="0 0 80 80" fill="none">
                        <circle cx="40" cy="40" r="36" stroke="#c9a959" stroke-width="2"/>
                        <circle cx="40" cy="40" r="28" stroke="#8b7355" stroke-width="1"/>
                        <path d="M40 12 L44 24 L40 20 L36 24 Z" fill="#8b2635"/>
                        <path d="M40 68 L44 56 L40 60 L36 56 Z" fill="#2d5a4a"/>
                        <path d="M12 40 L24 36 L20 40 L24 44 Z" fill="#2d5a4a"/>
                        <path d="M68 40 L56 36 L60 40 L56 44 Z" fill="#8b2635"/>
                        <circle cx="40" cy="40" r="6" fill="#c9a959"/>
                        <circle cx="40" cy="40" r="3" fill="#1a1612"/>
                    </svg>
                    <img id="customAvatar" style="display:none;" alt="Â§¥ÂÉè">
                    <div class="avatar-hint">Êõ¥Êç¢</div>
                </div>
                <h1>Á©øË∂äÁ≥ªÁªü</h1>
                <p>Êã©‰∏Ä‰∏ñÁïå ¬∑ ÂÆö‰∏ÄÂëΩËøê</p>
            </div>

            <!-- Menu Grid -->
            <div class="menu-grid">
                <div class="menu-card" data-menu="chuanyue">
                    <div class="menu-icon">
                        <svg viewBox="0 0 48 48" fill="none">
                            <circle cx="24" cy="24" r="18" stroke="#c9a959" stroke-width="2"/>
                            <path d="M24 6 L28 18 L24 14 L20 18 Z" fill="#8b2635"/>
                            <path d="M24 42 L28 30 L24 34 L20 30 Z" fill="#2d5a4a"/>
                            <circle cx="24" cy="24" r="5" fill="#c9a959"/>
                            <path d="M12 24 H18 M30 24 H36" stroke="#8b7355" stroke-width="2"/>
                        </svg>
                    </div>
                    <div class="menu-title">Á©øË∂ä</div>
                    <div class="menu-desc">ÁªèÂÖ∏Á©øË∂äÊ®°Âºè</div>
                </div>
                <div class="menu-card" data-menu="kuaichuan">
                    <div class="menu-icon">
                        <svg viewBox="0 0 48 48" fill="none">
                            <path d="M8 24 L24 8 L40 24 L24 40 Z" stroke="#8b2635" stroke-width="2" fill="none"/>
                            <path d="M16 24 L24 16 L32 24 L24 32 Z" stroke="#2d5a4a" stroke-width="2" fill="none"/>
                            <circle cx="24" cy="24" r="4" fill="#c9a959"/>
                            <path d="M24 4 V10 M24 38 V44 M4 24 H10 M38 24 H44" stroke="#8b7355" stroke-width="1.5"/>
                        </svg>
                    </div>
                    <div class="menu-title">Âø´Á©ø</div>
                    <div class="menu-desc">Â§ö‰∏ñÁïåÁ©øÊ¢≠</div>
                </div>
                <div class="menu-card" data-menu="chuanshu">
                    <div class="menu-icon">
                        <svg viewBox="0 0 48 48" fill="none">
                            <path d="M10 8 L10 40 Q10 42 12 42 L36 42 Q38 42 38 40 L38 8 Q38 6 36 6 L12 6 Q10 6 10 8 Z" stroke="#2d5a4a" stroke-width="2" fill="none"/>
                            <line x1="16" y1="14" x2="32" y2="14" stroke="#8b7355" stroke-width="1.5"/>
                            <line x1="16" y1="20" x2="32" y2="20" stroke="#8b7355" stroke-width="1.5"/>
                            <line x1="16" y1="26" x2="28" y2="26" stroke="#8b7355" stroke-width="1.5"/>
                            <circle cx="32" cy="34" r="6" fill="#8b2635"/>
                            <path d="M30 34 L32 36 L35 32" stroke="#e8dcc8" stroke-width="1.5" stroke-linecap="round"/>
                        </svg>
                    </div>
                    <div class="menu-title">Á©ø‰π¶</div>
                    <div class="menu-desc">ËøõÂÖ•‰π¶‰∏≠‰∏ñÁïå</div>
                </div>
                <div class="menu-card" data-menu="wuxianliu">
                    <div class="menu-icon">
                        <svg viewBox="0 0 48 48" fill="none">
                            <circle cx="24" cy="24" r="16" stroke="#8b2635" stroke-width="2" stroke-dasharray="4 2"/>
                            <path d="M24 8 V14 M24 34 V40 M8 24 H14 M34 24 H40" stroke="#c9a959" stroke-width="2"/>
                            <path d="M16 16 L20 20 M28 28 L32 32 M16 32 L20 28 M28 20 L32 16" stroke="#2d5a4a" stroke-width="1.5"/>
                            <circle cx="24" cy="24" r="6" fill="none" stroke="#c9a959" stroke-width="2"/>
                            <text x="24" y="27" text-anchor="middle" fill="#c9a959" font-size="8" font-weight="bold">‚àû</text>
                        </svg>
                    </div>
                    <div class="menu-title">Êó†ÈôêÊµÅ</div>
                    <div class="menu-desc">ÂâØÊú¨ÁîüÂ≠òÊåëÊàò</div>
                </div>
                <div class="menu-card" data-menu="settings">
                    <div class="menu-icon">
                        <svg viewBox="0 0 48 48" fill="none">
                            <circle cx="24" cy="24" r="8" stroke="#c9a959" stroke-width="2"/>
                            <path d="M24 4 L26 10 L22 10 Z M24 44 L26 38 L22 38 Z" fill="#8b7355"/>
                            <path d="M4 24 L10 26 L10 22 Z M44 24 L38 26 L38 22 Z" fill="#8b7355"/>
                            <path d="M9.86 9.86 L14 16 L12 14 Z M38.14 38.14 L34 32 L36 34 Z" fill="#8b7355"/>
                            <path d="M38.14 9.86 L32 14 L34 12 Z M9.86 38.14 L16 34 L14 36 Z" fill="#8b7355"/>
                            <circle cx="24" cy="24" r="3" fill="#2d5a4a"/>
                        </svg>
                    </div>
                    <div class="menu-title">ËÆæÁΩÆ</div>
                    <div class="menu-desc">Á≥ªÁªüÈÖçÁΩÆ</div>
                </div>
            </div>

            <!-- Preset Section -->
            <div class="expand-card" id="presetCard">
                <div class="expand-header" data-target="presetContent">
                    <div class="expand-icon">
                        <svg viewBox="0 0 24 24" fill="none">
                            <path d="M4 4 H20 V20 H4 Z" stroke="#c9a959" stroke-width="2" fill="none"/>
                            <path d="M8 8 H16 M8 12 H14 M8 16 H12" stroke="#8b7355" stroke-width="1.5" stroke-linecap="round"/>
                        </svg>
                    </div>
                    <div class="expand-info">
                        <div class="expand-title">È¢ÑËÆæ</div>
                        <div class="expand-desc">ËÆæÂÆöAIËßíËâ≤‰∏éË°å‰∏∫ËßÑËåÉ</div>
                    </div>
                    <svg class="expand-arrow" viewBox="0 0 20 20" fill="none">
                        <path d="M5 8 L10 13 L15 8" stroke="#7a6f5f" stroke-width="2" stroke-linecap="round"/>
                    </svg>
                </div>
                <div class="expand-content" id="presetContent">
                    <div class="preset-list" id="presetList">
                        <!-- Presets will be added here -->
                    </div>
                    <button class="add-btn" id="addPresetBtn">
                        <svg viewBox="0 0 24 24" fill="none">
                            <path d="M12 5 V19 M5 12 H19" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                        </svg>
                        <span>Ê∑ªÂä†È¢ÑËÆæ</span>
                    </button>
                </div>
            </div>

            <!-- World Book Section -->
            <div class="expand-card" id="worldBookCard">
                <div class="expand-header" data-target="worldBookContent">
                    <div class="expand-icon">
                        <svg viewBox="0 0 24 24" fill="none">
                            <path d="M4 19 V5 Q4 3 6 3 H18 Q20 3 20 5 V19 Q20 21 18 21 H6 Q4 21 4 19 Z" stroke="#2d5a4a" stroke-width="2" fill="none"/>
                            <path d="M4 17 H20" stroke="#2d5a4a" stroke-width="2"/>
                            <circle cx="12" cy="10" r="3" stroke="#c9a959" stroke-width="1.5"/>
                            <path d="M8 10 Q12 6 16 10" stroke="#8b7355" stroke-width="1"/>
                        </svg>
                    </div>
                    <div class="expand-info">
                        <div class="expand-title">‰∏ñÁïå‰π¶</div>
                        <div class="expand-desc">ÊãìÂ±ï‰∏ñÁïåËßÇ‰∏éÁü•ËØÜËÆæÂÆö</div>
                    </div>
                    <svg class="expand-arrow" viewBox="0 0 20 20" fill="none">
                        <path d="M5 8 L10 13 L15 8" stroke="#7a6f5f" stroke-width="2" stroke-linecap="round"/>
                    </svg>
                </div>
                <div class="expand-content" id="worldBookContent">
                    <div class="worldbook-list" id="worldBookList">
                        <!-- World book entries will be added here -->
                    </div>
                    <button class="add-btn" id="addWorldBookBtn">
                        <svg viewBox="0 0 24 24" fill="none">
                            <path d="M12 5 V19 M5 12 H19" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                        </svg>
                        <span>Ê∑ªÂä†ËØçÊù°</span>
                    </button>
                </div>
            </div>

            <!-- Collection & Archive Card -->
            <div class="menu-card collection-menu-card" id="collectionMenuCard">
                <div class="menu-icon">
                    <svg viewBox="0 0 48 48" fill="none">
                        <path d="M24 6 L30 18 L44 20 L34 30 L36 44 L24 38 L12 44 L14 30 L4 20 L18 18 Z" stroke="#c9a959" stroke-width="2" fill="none"/>
                    </svg>
                </div>
                <div class="menu-title">Êî∂Ëóè‰∏éÂ≠òÊ°£</div>
                <div class="menu-desc">Êü•ÁúãÊî∂ËóèÂÜÖÂÆπ</div>
            </div>

            <!-- Preset Edit Modal -->
            <div class="modal-overlay" id="presetModal">
                <div class="modal-box preset-modal">
                    <div class="modal-header">
                        <h3 id="presetModalTitle">Ê∑ªÂä†È¢ÑËÆæ</h3>
                        <button class="modal-close" id="presetModalClose">
                            <svg viewBox="0 0 28 28" fill="none">
                                <path d="M8 8 L20 20 M20 8 L8 20" stroke="#7a6f5f" stroke-width="2" stroke-linecap="round"/>
                            </svg>
                        </button>
                    </div>
                    <div class="modal-body">
                        <div class="form-item">
                            <label class="form-label">È¢ÑËÆæÂêçÁß∞</label>
                            <input type="text" class="form-input" id="presetName" placeholder="Â¶ÇÔºöÁ©øË∂äËÄÖÁ≥ªÁªüÂä©Êâã">
                        </div>
                        <div class="form-item">
                            <label class="form-label">‰ΩúÁî®ËåÉÂõ¥</label>
                            <select class="form-select" id="presetScope">
                                <option value="global">ÂÖ®Â±ÄÔºàÊâÄÊúâÊ®°ÂºèÔºâ</option>
                                <option value="chuanyue">‰ªÖÁ©øË∂äÊ®°Âºè</option>
                                <option value="kuaichuan">‰ªÖÂø´Á©øÊ®°Âºè</option>
                                <option value="chuanshu">‰ªÖÁ©ø‰π¶Ê®°Âºè</option>
                                <option value="wuxianliu">‰ªÖÊó†ÈôêÊµÅÊ®°Âºè</option>
                            </select>
                        </div>
                        <div class="form-item">
                            <label class="form-label">È¢ÑËÆæÂÜÖÂÆπ</label>
                            <textarea class="form-textarea" id="presetContentInput" rows="8" placeholder="ËæìÂÖ•Á≥ªÁªüÈ¢ÑËÆæÊèêÁ§∫ËØçÔºåÂÆö‰πâAIÁöÑËßíËâ≤„ÄÅË°å‰∏∫ËßÑËåÉ„ÄÅÂõûÂ§çÈ£éÊ†ºÁ≠â..."></textarea>
                        </div>
                        <div class="form-item">
                            <label class="form-label">
                                <input type="checkbox" id="presetEnabled" checked>
                                <span>ÂêØÁî®Ê≠§È¢ÑËÆæ</span>
                            </label>
                        </div>
                    </div>
                    <div class="modal-actions">
                        <button class="modal-btn modal-btn-cancel" id="presetModalCancel">ÂèñÊ∂à</button>
                        <button class="modal-btn modal-btn-confirm" id="presetModalSave">‰øùÂ≠ò</button>
                    </div>
                </div>
            </div>

            <!-- World Book Edit Modal -->
            <div class="modal-overlay" id="worldBookModal">
                <div class="modal-box worldbook-modal">
                    <div class="modal-header">
                        <h3 id="worldBookModalTitle">Ê∑ªÂä†ËØçÊù°</h3>
                        <button class="modal-close" id="worldBookModalClose">
                            <svg viewBox="0 0 28 28" fill="none">
                                <path d="M8 8 L20 20 M20 8 L8 20" stroke="#7a6f5f" stroke-width="2" stroke-linecap="round"/>
                            </svg>
                        </button>
                    </div>
                    <div class="modal-body">
                        <div class="form-row">
                            <div class="form-item form-item-half">
                                <label class="form-label">ÂàÜÁ±ª</label>
                                <input type="text" class="form-input" id="worldBookCategory" list="categoryList" placeholder="ÈÄâÊã©ÊàñËæìÂÖ•">
                                <datalist id="categoryList"></datalist>
                            </div>
                            <div class="form-item form-item-half">
                                <label class="form-label">‰ºòÂÖàÁ∫ß</label>
                                <input type="number" class="form-input" id="worldBookPriority" value="50" min="0" max="100">
                            </div>
                        </div>
                        <div class="form-item">
                            <label class="form-label">‰ΩúÁî®ËåÉÂõ¥</label>
                            <select class="form-select" id="worldBookScope">
                                <option value="global">ÂÖ®Â±ÄÔºàÊâÄÊúâÊ®°ÂºèÔºâ</option>
                                <option value="chuanyue">‰ªÖÁ©øË∂äÊ®°Âºè</option>
                                <option value="kuaichuan">‰ªÖÂø´Á©øÊ®°Âºè</option>
                                <option value="chuanshu">‰ªÖÁ©ø‰π¶Ê®°Âºè</option>
                                <option value="wuxianliu">‰ªÖÊó†ÈôêÊµÅÊ®°Âºè</option>
                            </select>
                        </div>
                        <div class="form-item">
                            <label class="form-label">ÂÖ≥ÈîÆËØç <span class="form-hint">ÔºàÁî®ÈÄóÂè∑ÂàÜÈöîÂ§ö‰∏™ÂÖ≥ÈîÆËØçÔºâ</span></label>
                            <input type="text" class="form-input" id="worldBookKeywords" placeholder="Â¶ÇÔºö‰ªô‰æ†,‰øÆ‰ªô,ÁÅµÊ∞î">
                        </div>
                        <div class="form-item">
                            <label class="form-label">ËØçÊù°ÂÜÖÂÆπ</label>
                            <textarea class="form-textarea" id="worldBookEntryInput" rows="6" placeholder="ÂΩìÂØπËØù‰∏≠Âá∫Áé∞ÂÖ≥ÈîÆËØçÊó∂ÔºåÊ≠§ÂÜÖÂÆπÂ∞ÜË¢´Ê≥®ÂÖ•Âà∞AI‰∏ä‰∏ãÊñá‰∏≠..."></textarea>
                        </div>
                        <div class="form-item">
                            <label class="form-label">
                                <input type="checkbox" id="worldBookEnabled" checked>
                                <span>ÂêØÁî®Ê≠§ËØçÊù°</span>
                            </label>
                        </div>
                    </div>
                    <div class="modal-actions">
                        <button class="modal-btn modal-btn-cancel" id="worldBookModalCancel">ÂèñÊ∂à</button>
                        <button class="modal-btn modal-btn-confirm" id="worldBookModalSave">‰øùÂ≠ò</button>
                    </div>
                </div>
            </div>

            <!-- Avatar Modal -->
            <div class="modal-overlay" id="avatarModal">
                <div class="modal-box">
                    <div class="modal-header">
                        <h3>Êõ¥Êç¢Â§¥ÂÉè</h3>
                        <button class="modal-close" id="modalClose">
                            <svg viewBox="0 0 28 28" fill="none">
                                <path d="M8 8 L20 20 M20 8 L8 20" stroke="#7a6f5f" stroke-width="2" stroke-linecap="round"/>
                            </svg>
                        </button>
                    </div>
                    <div class="modal-preview" id="modalPreview">
                        <svg viewBox="0 0 80 80" fill="none">
                            <circle cx="40" cy="40" r="36" stroke="#c9a959" stroke-width="2"/>
                            <circle cx="40" cy="40" r="28" stroke="#8b7355" stroke-width="1"/>
                            <path d="M40 12 L44 24 L40 20 L36 24 Z" fill="#8b2635"/>
                            <path d="M40 68 L44 56 L40 60 L36 56 Z" fill="#2d5a4a"/>
                            <path d="M12 40 L24 36 L20 40 L24 44 Z" fill="#2d5a4a"/>
                            <path d="M68 40 L56 36 L60 40 L56 44 Z" fill="#8b2635"/>
                            <circle cx="40" cy="40" r="6" fill="#c9a959"/>
                            <circle cx="40" cy="40" r="3" fill="#1a1612"/>
                        </svg>
                    </div>
                    <div class="modal-tabs">
                        <button class="modal-tab active" data-tab="local">Êú¨Âú∞‰∏ä‰º†</button>
                        <button class="modal-tab" data-tab="url">ÁΩëÁªúÂõæÁâá</button>
                    </div>
                    <div class="modal-content active" id="localTab">
                        <div class="file-input-wrapper">
                            <div class="file-input-btn">
                                <svg viewBox="0 0 24 24" fill="none">
                                    <path d="M12 4 L12 16 M7 9 L12 4 L17 9" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                    <path d="M4 17 L4 19 Q4 20 5 20 L19 20 Q20 20 20 19 L20 17" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                                </svg>
                                <span>ÈÄâÊã©ÂõæÁâáÊñá‰ª∂</span>
                            </div>
                            <input type="file" id="fileInput" accept="image/*">
                        </div>
                    </div>
                    <div class="modal-content" id="urlTab">
                        <input type="text" class="url-input" id="urlInput" placeholder="ËæìÂÖ•ÂõæÁâáURLÂú∞ÂùÄ...">
                    </div>
                    <div class="modal-actions">
                        <button class="modal-btn modal-btn-cancel" id="modalCancel">ÂèñÊ∂à</button>
                        <button class="modal-btn modal-btn-confirm" id="modalConfirm">Á°ÆÂÆö</button>
                    </div>
                    <button class="modal-btn modal-btn-reset" id="modalReset">ÊÅ¢Â§çÈªòËÆ§Â§¥ÂÉè</button>
                </div>
            </div>

        </div>

        <!-- Chuanyue (Transmigration) Section -->
        <div class="section" id="chuanyueSection">
            <!-- Sidebar Overlay -->
            <div class="sidebar-overlay" id="sidebarOverlay"></div>
            <!-- Sidebar -->
            <div class="chuanyue-sidebar collapsed" id="chuanyueSidebar">
                <div class="sidebar-header">
                    <button class="sidebar-back" id="chuanyueBack">
                        <svg viewBox="0 0 24 24" fill="none">
                            <path d="M15 18 L9 12 L15 6" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                        </svg>
                    </button>
                    <h2 id="gameModeTitle">Á©øË∂äÊ®°Âºè</h2>
                    <button class="sidebar-toggle" id="sidebarToggle">
                        <svg viewBox="0 0 24 24" fill="none">
                            <path d="M4 6 H20 M4 12 H20 M4 18 H20" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                        </svg>
                    </button>
                </div>
                
                <div class="sidebar-content">
                    <!-- Character Profile Card -->
                    <div class="profile-card" id="profileCard">
                        <div class="profile-header">
                            <div class="profile-icon">
                                <svg viewBox="0 0 24 24" fill="none">
                                    <circle cx="12" cy="8" r="4" stroke="#c9a959" stroke-width="2"/>
                                    <path d="M4 20 Q4 14 12 14 Q20 14 20 20" stroke="#c9a959" stroke-width="2"/>
                                </svg>
                            </div>
                            <div class="profile-title">ÊàëÁöÑ‰∫∫ËÆæ</div>
                            <button class="profile-edit-btn" id="editProfileBtn" title="ÁºñËæë‰∫∫ËÆæ">
                                <svg viewBox="0 0 24 24" fill="none">
                                    <path d="M16 3 L21 8 L8 21 H3 V16 Z" stroke="currentColor" stroke-width="2"/>
                                </svg>
                            </button>
                        </div>
                        <div class="profile-body" id="profileBody">
                            <div class="profile-empty">
                                <p>Â∞öÊú™ËÆæÁΩÆ‰∫∫ËÆæ</p>
                                <button class="profile-create-btn" id="createProfileBtn">ÂàõÂª∫‰∫∫ËÆæ</button>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Shop Card (Âø´Á©øÊ®°Âºè‰∏ìÁî®) -->
                    <div class="sidebar-card shop-card" id="shopCard" style="display: none;">
                        <div class="sidebar-card-header clickable" id="shopHeader">
                            <div class="sidebar-card-icon">
                                <svg viewBox="0 0 24 24" fill="none">
                                    <path d="M3 3 H5 L5.4 5 M7 13 H17 L21 5 H5.4 M7 13 L5.4 5 M7 13 L4.7 17.6 C4.2 18.5 4.9 19.5 5.9 19.5 H17 M17 19.5 C15.9 19.5 15 20.4 15 21.5 C15 22.6 15.9 23.5 17 23.5 C18.1 23.5 19 22.6 19 21.5 C19 20.4 18.1 19.5 17 19.5 M9 21.5 C9 22.6 8.1 23.5 7 23.5 C5.9 23.5 5 22.6 5 21.5 C5 20.4 5.9 19.5 7 19.5 C8.1 19.5 9 20.4 9 21.5" stroke="#c9a959" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                </svg>
                            </div>
                            <div class="sidebar-card-title">Á≥ªÁªüÂïÜÂüé</div>
                            <div class="shop-points" id="shopPoints">
                                <span class="points-icon">üíé</span>
                                <span class="points-value" id="currentPoints">0</span>
                            </div>
                        </div>
                        <div class="sidebar-card-body" id="shopBody">
                            <div class="shop-hint">ÁÇπÂáªÊü•ÁúãÂïÜÂüéÂïÜÂìÅ</div>
                        </div>
                    </div>
                    
                    <!-- Transmigrated Character Card -->
                    <div class="sidebar-card collapsible" id="transCharCard">
                        <div class="sidebar-card-header clickable" id="transCharHeader">
                            <div class="sidebar-card-icon">
                                <svg viewBox="0 0 24 24" fill="none">
                                    <path d="M12 2 L15 8 L22 9 L17 14 L18 21 L12 18 L6 21 L7 14 L2 9 L9 8 Z" stroke="#c9a959" stroke-width="2" stroke-linejoin="round"/>
                                </svg>
                            </div>
                            <div class="sidebar-card-title" id="transCharTitle">Á©øË∂ä‰∫∫ËÆæ</div>
                            <button class="sidebar-card-refresh" id="refreshTransCharBtn" title="ÁîüÊàêÁ©øË∂ä‰∫∫ËÆæ">
                                <svg viewBox="0 0 24 24" fill="none">
                                    <path d="M1 4 v6 h6 M23 20 v-6 h-6" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                    <path d="M20.49 9 A9 9 0 0 0 5.64 5.64 L1 10 M23 14 l-4.64 4.36 A9 9 0 0 1 3.51 15" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                </svg>
                            </button>
                            <div class="sidebar-card-toggle">
                                <svg viewBox="0 0 24 24" fill="none">
                                    <path d="M6 9 L12 15 L18 9" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                </svg>
                            </div>
                        </div>
                        <div class="sidebar-card-body collapsed" id="transCharBody">
                            <div class="trans-char-empty">
                                <p>ÁÇπÂáªÂà∑Êñ∞ÊåâÈíÆÁîüÊàêÁ©øË∂ä‰∫∫ËÆæ</p>
                                <small>Ê≥®ÊÑèÔºöÊØè‰∏™‰∏ñÁïåÂè™ËÉΩÁîüÊàê‰∏ÄÊ¨°</small>
                            </div>
                        </div>
                    </div>
                    
                    <!-- World Info Card (Collapsible) -->
                    <div class="sidebar-card collapsible" id="worldInfoCard" style="display: none;">
                        <div class="sidebar-card-header clickable" id="worldInfoHeader">
                            <div class="sidebar-card-icon">
                                <svg viewBox="0 0 24 24" fill="none">
                                    <circle cx="12" cy="12" r="10" stroke="#c9a959" stroke-width="2"/>
                                    <path d="M2 12 H22 M12 2 C15 6 15 18 12 22 M12 2 C9 6 9 18 12 22" stroke="#c9a959" stroke-width="2"/>
                                </svg>
                            </div>
                            <div class="sidebar-card-title">‰∏ñÁïåËÉåÊôØ</div>
                            <div class="sidebar-card-toggle">
                                <svg viewBox="0 0 24 24" fill="none">
                                    <path d="M6 9 L12 15 L18 9" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                </svg>
                            </div>
                        </div>
                        <div class="sidebar-card-body collapsed" id="worldInfoBody">
                            <!-- Will be filled by JS -->
                        </div>
                    </div>
                    
                    <!-- World Building Card (Collapsible) -->
                    <div class="sidebar-card collapsible" id="worldBuildingCard" style="display: none;">
                        <div class="sidebar-card-header clickable" id="worldBuildingHeader">
                            <div class="sidebar-card-icon">
                                <svg viewBox="0 0 24 24" fill="none">
                                    <path d="M3 21 L21 21 M5 21 V7 L12 3 L19 7 V21 M9 21 V15 H15 V21" stroke="#c9a959" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                </svg>
                            </div>
                            <div class="sidebar-card-title">‰∏ñÁïåËÆæÂÆö</div>
                            <button class="sidebar-card-refresh" id="refreshWorldBuilding" title="ÁîüÊàê‰∏ñÁïåËÆæÂÆö">
                                <svg viewBox="0 0 24 24" fill="none">
                                    <path d="M1 4 v6 h6 M23 20 v-6 h-6" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                    <path d="M20.49 9 A9 9 0 0 0 5.64 5.64 L1 10 M23 14 l-4.64 4.36 A9 9 0 0 1 3.51 15" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                </svg>
                            </button>
                            <div class="sidebar-card-toggle">
                                <svg viewBox="0 0 24 24" fill="none">
                                    <path d="M6 9 L12 15 L18 9" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                </svg>
                            </div>
                        </div>
                        <div class="sidebar-card-body collapsed" id="worldBuildingBody">
                            <div class="world-building-empty">
                                <p>ÁÇπÂáªÂà∑Êñ∞ÊåâÈíÆÁîüÊàê‰∏ñÁïåËÆæÂÆö</p>
                                <small>Ê≥®ÊÑèÔºöÂè™ËÉΩÁîüÊàê‰∏ÄÊ¨°</small>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Restart Button -->
                    <button class="sidebar-restart-btn" id="restartBtn">
                        <svg viewBox="0 0 24 24" fill="none">
                            <path d="M1 4 v6 h6 M23 20 v-6 h-6" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                            <path d="M20.49 9 A9 9 0 0 0 5.64 5.64 L1 10 M23 14 l-4.64 4.36 A9 9 0 0 1 3.51 15" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                        </svg>
                        <span>ÈáçÊñ∞ÂºÄÂßã</span>
                    </button>
                    
                </div>
            </div>
            
            <!-- Main Content Area -->
            <div class="chuanyue-main" id="chuanyueMain">
                <!-- Floating menu button when sidebar is collapsed -->
                <button class="floating-menu-btn" id="floatingMenuBtn" title="Â±ïÂºÄ‰æßËæπÊ†è">
                    <svg viewBox="0 0 24 24" fill="none">
                        <path d="M4 6 H20 M4 12 H20 M4 18 H20" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                    </svg>
                </button>
                
                <!-- Placeholder (before start) -->
                <div class="chuanyue-placeholder" id="chuanyuePlaceholder">
                    <div class="placeholder-icon">
                        <svg viewBox="0 0 80 80" fill="none">
                            <circle cx="40" cy="40" r="35" stroke="#3d352a" stroke-width="2"/>
                            <circle cx="40" cy="40" r="25" stroke="#c9a959" stroke-width="2" stroke-dasharray="8 4"/>
                            <path d="M40 15 L44 30 L40 25 L36 30 Z" fill="#8b2635"/>
                            <path d="M40 65 L44 50 L40 55 L36 50 Z" fill="#2d5a4a"/>
                            <circle cx="40" cy="40" r="8" fill="#c9a959"/>
                        </svg>
                    </div>
                    <p>ËØ∑ÂÖàËÆæÁΩÆ‰Ω†ÁöÑ‰∫∫ËÆæÔºåÁÑ∂ÂêéÂºÄÂßãÁ©øË∂ä‰πãÊóÖ</p>
                    <button class="start-chuanyue-btn" id="startChuanyueBtn">
                        <svg viewBox="0 0 24 24" fill="none">
                            <circle cx="12" cy="12" r="10" stroke="currentColor" stroke-width="2"/>
                            <path d="M10 8 L16 12 L10 16 Z" fill="currentColor"/>
                        </svg>
                        <span>ÂºÄÂßãÁ©øË∂ä</span>
                    </button>
                </div>
                
                <!-- Chat Interface (after start) -->
                <div class="chat-interface" id="chatInterface" style="display: none;">
                    <!-- Status Bar -->
                    <div class="chat-status-bar" id="chatStatusBar">
                        <div class="status-item">
                            <svg viewBox="0 0 24 24" fill="none"><rect x="3" y="4" width="18" height="18" rx="2" stroke="currentColor" stroke-width="2"/><path d="M16 2 V6 M8 2 V6 M3 10 H21" stroke="currentColor" stroke-width="2" stroke-linecap="round"/></svg>
                            <span id="statusDate">--</span>
                        </div>
                        <div class="status-item">
                            <svg viewBox="0 0 24 24" fill="none"><circle cx="12" cy="12" r="10" stroke="currentColor" stroke-width="2"/><path d="M12 6 V12 L16 14" stroke="currentColor" stroke-width="2" stroke-linecap="round"/></svg>
                            <span id="statusTime">--:--</span>
                        </div>
                        <div class="status-item">
                            <svg viewBox="0 0 24 24" fill="none"><path d="M12 2 C8 6 4 10 4 14 a8 8 0 1 0 16 0 c0-4-4-8-8-12z" stroke="currentColor" stroke-width="2"/></svg>
                            <span id="statusLocation">--</span>
                        </div>
                        <div class="status-item">
                            <svg viewBox="0 0 24 24" fill="none"><path d="M12 2 v2 M12 20 v2 M4 12 H2 M22 12 h-2 M6.34 6.34 L4.93 4.93 M19.07 4.93 l-1.41 1.41 M6.34 17.66 l-1.41 1.41 M19.07 19.07 l-1.41-1.41" stroke="currentColor" stroke-width="2" stroke-linecap="round"/><circle cx="12" cy="12" r="4" stroke="currentColor" stroke-width="2"/></svg>
                            <span id="statusWeather">--</span>
                        </div>
                        <button class="status-save-btn" id="saveArchiveBtn" title="‰øùÂ≠òÂ≠òÊ°£">
                            <svg viewBox="0 0 24 24" fill="none"><path d="M19 21 H5 Q3 21 3 19 V5 Q3 3 5 3 H16 L21 8 V19 Q21 21 19 21 Z" stroke="currentColor" stroke-width="2"/><path d="M7 3 V8 H15" stroke="currentColor" stroke-width="2"/><rect x="7" y="13" width="10" height="8" stroke="currentColor" stroke-width="2"/></svg>
                        </button>
                    </div>
                    
                    <!-- Messages Area -->
                    <div class="chat-messages" id="chatMessages">
                        <!-- Messages will be inserted here -->
                    </div>
                    
                    <!-- Input Area -->
                    <div class="chat-input-area">
                        <textarea class="chat-input" id="chatInput" placeholder="ÊèèËø∞‰Ω†ÁöÑË°åÂä®ÊàñÂØπËØù..." rows="1"></textarea>
                        <button class="chat-more-btn" id="chatMoreBtn" title="Êõ¥Â§öÈÄâÈ°π">
                            <svg viewBox="0 0 24 24" fill="none">
                                <circle cx="12" cy="5" r="2" fill="currentColor"/>
                                <circle cx="12" cy="12" r="2" fill="currentColor"/>
                                <circle cx="12" cy="19" r="2" fill="currentColor"/>
                            </svg>
                        </button>
                        <button class="chat-send-btn" id="chatSendBtn" title="ÂèëÈÄÅÊ∂àÊÅØ">
                            <svg viewBox="0 0 24 24" fill="none">
                                <path d="M22 2 L11 13 M22 2 L15 22 L11 13 L2 9 Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                            </svg>
                        </button>
                        <button class="chat-generate-btn" id="chatGenerateBtn" title="ÁîüÊàêAIÂõûÂ§ç">
                            <svg viewBox="0 0 24 24" fill="none">
                                <path d="M12 2 L12 6 M12 18 L12 22 M2 12 L6 12 M18 12 L22 12" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                                <circle cx="12" cy="12" r="4" stroke="currentColor" stroke-width="2"/>
                            </svg>
                        </button>
                    </div>
                    
                    <!-- Message Context Menu -->
                    <div class="message-context-menu" id="messageContextMenu">
                        <button class="context-menu-item" id="contextFavorite">
                            <svg viewBox="0 0 24 24" fill="none">
                                <path d="M12 2 L15 8 L22 9 L17 14 L18 21 L12 18 L6 21 L7 14 L2 9 L9 8 Z" stroke="currentColor" stroke-width="2" stroke-linejoin="round"/>
                            </svg>
                            <span>Êî∂Ëóè</span>
                        </button>
                        <button class="context-menu-item" id="contextEdit" style="display: none;">
                            <svg viewBox="0 0 24 24" fill="none">
                                <path d="M16 3 L21 8 L8 21 H3 V16 Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                            </svg>
                            <span>ÁºñËæë</span>
                        </button>
                        <button class="context-menu-item" id="contextRegenerate">
                            <svg viewBox="0 0 24 24" fill="none">
                                <path d="M1 4 v6 h6 M23 20 v-6 h-6" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                <path d="M20.49 9 A9 9 0 0 0 5.64 5.64 L1 10 M23 14 l-4.64 4.36 A9 9 0 0 1 3.51 15" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                            </svg>
                            <span>ÈáçÊñ∞ÁîüÊàê</span>
                        </button>
                        <button class="context-menu-item context-menu-danger" id="contextDelete">
                            <svg viewBox="0 0 24 24" fill="none">
                                <path d="M3 6 H21 M8 6 V4 a2 2 0 0 1 2-2 h4 a2 2 0 0 1 2 2 v2 M19 6 v14 a2 2 0 0 1-2 2 H7 a2 2 0 0 1-2-2 V6" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                            </svg>
                            <span>Âà†Èô§</span>
                        </button>
                    </div>

                    <!-- Bottom Sheet -->
                    <div class="bottom-sheet-overlay" id="bottomSheetOverlay"></div>
                    <div class="bottom-sheet" id="bottomSheet">
                        <div class="bottom-sheet-handle"></div>
                        <div class="bottom-sheet-grid">
                            <button class="bottom-sheet-app" id="btnSummary">
                                <div class="app-icon app-icon-gold">
                                    <svg viewBox="0 0 24 24" fill="none">
                                        <path d="M9 5 H7 a2 2 0 0 0-2 2 v12 a2 2 0 0 0 2 2 h10 a2 2 0 0 0 2-2 V7 a2 2 0 0 0-2-2 h-2" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                                        <path d="M9 5 a2 2 0 0 1 2-2 h2 a2 2 0 0 1 2 2 a2 2 0 0 1-2 2 h-2 a2 2 0 0 1-2-2z" stroke="currentColor" stroke-width="2"/>
                                        <path d="M9 12 H15 M9 16 H13" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                                    </svg>
                                </div>
                                <span>ÊÄªÁªì</span>
                            </button>
                            <button class="bottom-sheet-app" id="btnStatus">
                                <div class="app-icon app-icon-green">
                                    <svg viewBox="0 0 24 24" fill="none">
                                        <circle cx="12" cy="8" r="5" stroke="currentColor" stroke-width="2"/>
                                        <path d="M3 21 C3 16.5 7 13 12 13 C17 13 21 16.5 21 21" stroke="currentColor" stroke-width="2"/>
                                        <path d="M16 6 L18 8 L22 4" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                    </svg>
                                </div>
                                <span>Áä∂ÊÄÅÊ†è</span>
                            </button>
                            <button class="bottom-sheet-app" id="btnTask">
                                <div class="app-icon app-icon-blue">
                                    <svg viewBox="0 0 24 24" fill="none">
                                        <path d="M9 11 L12 14 L22 4" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                        <path d="M21 12 v7 a2 2 0 0 1-2 2 H5 a2 2 0 0 1-2-2 V5 a2 2 0 0 1 2-2 h11" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                    </svg>
                                </div>
                                <span>‰ªªÂä°</span>
                            </button>
                            <button class="bottom-sheet-app" id="btnCharacters">
                                <div class="app-icon app-icon-pink">
                                    <svg viewBox="0 0 24 24" fill="none">
                                        <circle cx="9" cy="7" r="4" stroke="currentColor" stroke-width="2"/>
                                        <path d="M3 21 v-2 a4 4 0 0 1 4-4 h4 a4 4 0 0 1 4 4 v2" stroke="currentColor" stroke-width="2"/>
                                        <circle cx="17" cy="7" r="3" stroke="currentColor" stroke-width="2"/>
                                        <path d="M21 21 v-2 a3 3 0 0 0-3-3 h-1" stroke="currentColor" stroke-width="2"/>
                                    </svg>
                                </div>
                                <span>‰∫∫Áâ©</span>
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Transmigrated Character Modal -->
    <div class="modal-overlay" id="transCharModal">
        <div class="modal-box trans-char-modal">
            <div class="modal-header">
                <h3>Á©øË∂ä‰∫∫ËÆæ</h3>
                <button class="modal-close" id="transCharModalClose">
                    <svg viewBox="0 0 24 24" fill="none">
                        <path d="M18 6 L6 18 M6 6 L18 18" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                    </svg>
                </button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label>Á©øË∂äÂêéÁöÑË∫´‰ªΩÂêçÁß∞</label>
                    <input type="text" id="transCharName" placeholder="Â¶ÇÔºöÊùéÂ∫úÂ´°Â•≥„ÄÅÂ∞ÜÂÜõÂ∫úÂ∫∂Â≠ê">
                </div>
                <div class="form-group">
                    <label>Ë∫´‰ªΩËÉåÊôØ</label>
                    <textarea id="transCharBackground" rows="3" placeholder="Á©øË∂äÂêéËßíËâ≤ÁöÑÂÆ∂‰∏ñËÉåÊôØ„ÄÅÁ§æ‰ºöÂú∞‰ΩçÁ≠â"></textarea>
                </div>
                <div class="form-group">
                    <label>ÂΩìÂâçÂ§ÑÂ¢É</label>
                    <textarea id="transCharSituation" rows="3" placeholder="ËßíËâ≤ÁõÆÂâçÈù¢‰∏¥ÁöÑÂõ∞Â¢ÉÊàñÁä∂ÂÜµ"></textarea>
                </div>
                <div class="form-group">
                    <label>ÁâπÊÆäËÉΩÂäõ/ÈáëÊâãÊåá</label>
                    <textarea id="transCharAbility" rows="2" placeholder="Á©øË∂äÂêéËé∑ÂæóÁöÑÁâπÊÆäËÉΩÂäõÔºàÂèØÈÄâÔºâ"></textarea>
                </div>
                <div class="form-group">
                    <label>ÂÖ∂‰ªñÂ§áÊ≥®</label>
                    <textarea id="transCharNotes" rows="2" placeholder="ÂÖ∂‰ªñÈúÄË¶ÅË°•ÂÖÖÁöÑËÆæÂÆö"></textarea>
                </div>
                <button class="ai-polish-btn" id="aiPolishTransChar">
                    <svg viewBox="0 0 24 24" fill="none">
                        <path d="M12 2 L12 6 M12 18 L12 22 M4.93 4.93 L7.76 7.76 M16.24 16.24 L19.07 19.07 M2 12 L6 12 M18 12 L22 12 M4.93 19.07 L7.76 16.24 M16.24 7.76 L19.07 4.93" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                    </svg>
                    <span>AI ÂÆåÂñÑ</span>
                </button>
            </div>
            <div class="modal-footer">
                <button class="modal-btn modal-btn-cancel" id="transCharModalCancel">ÂèñÊ∂à</button>
                <button class="modal-btn modal-btn-confirm" id="transCharModalConfirm">‰øùÂ≠ò</button>
            </div>
        </div>
    </div>

    <!-- Summary Modal -->
    <div class="modal-overlay" id="summaryModal">
        <div class="modal-box summary-modal">
            <div class="modal-header">
                <h3>üìã ÊïÖ‰∫ãÊÄªÁªì</h3>
                <button class="modal-close" id="summaryModalClose">
                    <svg viewBox="0 0 24 24" fill="none">
                        <path d="M18 6 L6 18 M6 6 L18 18" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                    </svg>
                </button>
            </div>
            <div class="summary-content">
                <textarea class="summary-textarea" id="summaryTextarea" placeholder="ÊöÇÊó†ÊÄªÁªìÂÜÖÂÆπ..."></textarea>
            </div>
            <div class="summary-actions">
                <button class="summary-btn summary-btn-generate" id="summaryGenerateBtn">
                    <svg viewBox="0 0 24 24" fill="none">
                        <path d="M12 2 L12 6 M12 18 L12 22 M4.93 4.93 L7.76 7.76 M16.24 16.24 L19.07 19.07 M2 12 L6 12 M18 12 L22 12 M4.93 19.07 L7.76 16.24 M16.24 7.76 L19.07 4.93" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                    </svg>
                    <span>AIÊÄªÁªì</span>
                </button>
                <button class="summary-btn summary-btn-save" id="summarySaveBtn">
                    <svg viewBox="0 0 24 24" fill="none">
                        <path d="M19 21 H5 a2 2 0 0 1-2-2 V5 a2 2 0 0 1 2-2 h11 l5 5 v11 a2 2 0 0 1-2 2z" stroke="currentColor" stroke-width="2"/>
                        <path d="M17 21 V13 H7 v8 M7 3 v5 h8" stroke="currentColor" stroke-width="2"/>
                    </svg>
                    <span>‰øùÂ≠ò</span>
                </button>
            </div>
        </div>
    </div>

    <!-- Characters Modal -->
    <div class="modal-overlay" id="charactersModal">
        <div class="modal-box characters-modal">
            <div class="modal-header">
                <h3>üë• ÈáçË¶Å‰∫∫Áâ©</h3>
                <div class="modal-header-actions">
                    <button class="modal-refresh-btn" id="charactersRefreshBtn" title="AIÂà∑Êñ∞‰∫∫Áâ©">
                        <svg viewBox="0 0 24 24" fill="none">
                            <path d="M21 12a9 9 0 11-2.63-6.36M21 3v6h-6" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                        </svg>
                    </button>
                    <button class="modal-close" id="charactersModalClose">
                        <svg viewBox="0 0 24 24" fill="none">
                            <path d="M18 6 L6 18 M6 6 L18 18" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                        </svg>
                    </button>
                </div>
            </div>
            <div class="characters-content" id="charactersContent">
                <div class="status-empty">Â∞öÊú™ÁîüÊàêÈáçË¶Å‰∫∫Áâ©</div>
            </div>
            <div class="character-detail" id="characterDetail" style="display:none;">
                <div class="map-detail-header">
                    <button class="map-back-btn" id="characterBackBtn">
                        <svg viewBox="0 0 24 24" fill="none">
                            <path d="M19 12 H5 M12 19 l-7-7 7-7" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                        </svg>
                    </button>
                    <h4 id="characterDetailTitle">‰∫∫Áâ©ÂêçÁß∞</h4>
                </div>
                <div class="character-detail-body" id="characterDetailBody"></div>
            </div>
        </div>
    </div>

    <!-- Task Modal -->
    <div class="modal-overlay" id="taskModal">
        <div class="modal-box task-modal">
            <div class="modal-header">
                <h3>üéØ ‰ªªÂä°ËøõÂ∫¶</h3>
                <div class="modal-header-actions">
                    <button class="modal-refresh-btn" id="taskRefreshBtn" title="AIÂà∑Êñ∞‰ªªÂä°">
                        <svg viewBox="0 0 24 24" fill="none">
                            <path d="M21 12a9 9 0 11-2.63-6.36M21 3v6h-6" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                        </svg>
                    </button>
                    <button class="modal-close" id="taskModalClose">
                        <svg viewBox="0 0 24 24" fill="none">
                            <path d="M18 6 L6 18 M6 6 L18 18" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                        </svg>
                    </button>
                </div>
            </div>
            <div class="task-content" id="taskContent">
                <div class="task-empty">
                    <p>ÊöÇÊó†‰ªªÂä°</p>
                    <small>ÂºÄÂßãÊ∏∏ÊàèÂêé‰ªªÂä°‰ºöËá™Âä®ÁîüÊàê</small>
                </div>
            </div>
        </div>
    </div>

    <!-- Status Modal -->
    <div class="modal-overlay" id="statusModal">
        <div class="modal-box status-modal">
            <div class="modal-header">
                <h3>üìä Áä∂ÊÄÅÊ†è</h3>
                <div class="modal-header-actions">
                    <button class="modal-refresh-btn" id="statusRefreshBtn" title="AIÂà∑Êñ∞Áä∂ÊÄÅ">
                        <svg viewBox="0 0 24 24" fill="none">
                            <path d="M21 12a9 9 0 11-2.63-6.36M21 3v6h-6" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                        </svg>
                    </button>
                    <button class="modal-close" id="statusModalClose">
                        <svg viewBox="0 0 24 24" fill="none">
                            <path d="M18 6 L6 18 M6 6 L18 18" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                        </svg>
                    </button>
                </div>
            </div>
            <div class="status-content" id="statusContent">
                <!-- Status Section -->
                <div class="status-section">
                    <div class="status-section-header">
                        <span class="status-section-title">üé≠ ÂΩìÂâçÁä∂ÊÄÅ</span>
                        <button class="status-edit-btn" data-section="currentStatus">ÁºñËæë</button>
                    </div>
                    <div class="status-section-body" id="statusCurrent">
                        <div class="status-empty">ÊöÇÊó†Áä∂ÊÄÅ‰ø°ÊÅØ</div>
                    </div>
                </div>
                
                <!-- Relationships Section -->
                <div class="status-section">
                    <div class="status-section-header">
                        <span class="status-section-title">üíï Â•ΩÊÑüÂ∫¶</span>
                        <button class="status-edit-btn" data-section="affection">ÁºñËæë</button>
                    </div>
                    <div class="status-section-body" id="statusAffection">
                        <div class="status-empty">ÊöÇÊó†ÂèØÊîªÁï•ËßíËâ≤</div>
                    </div>
                </div>
                
                <!-- Friends Section -->
                <div class="status-section">
                    <div class="status-section-header">
                        <span class="status-section-title">ü§ù Â•ΩÂèã</span>
                        <button class="status-edit-btn" data-section="friends">ÁºñËæë</button>
                    </div>
                    <div class="status-section-body" id="statusFriends">
                        <div class="status-empty">ÊöÇÊó†Â•ΩÂèã</div>
                    </div>
                </div>
                
                <!-- Enemies Section -->
                <div class="status-section">
                    <div class="status-section-header">
                        <span class="status-section-title">‚öîÔ∏è ÊïåÂØπ</span>
                        <button class="status-edit-btn" data-section="enemies">ÁºñËæë</button>
                    </div>
                    <div class="status-section-body" id="statusEnemies">
                        <div class="status-empty">ÊöÇÊó†ÊïåÂØπÂÖ≥Á≥ª</div>
                    </div>
                </div>
                
                <!-- Inventory Section -->
                <div class="status-section">
                    <div class="status-section-header">
                        <span class="status-section-title">üéí Áâ©ÂìÅ</span>
                        <button class="status-edit-btn" data-section="inventory">ÁºñËæë</button>
                    </div>
                    <div class="status-section-body" id="statusInventory">
                        <div class="status-empty">ÊöÇÊó†Áâ©ÂìÅ</div>
                    </div>
                </div>
                
                <!-- Custom Status Sections (Âä®ÊÄÅÁîüÊàê) -->
                <div id="customStatusSections"></div>
            </div>
            <div class="status-actions">
                <button class="status-btn status-btn-ai" id="statusAiUpdate">
                    <svg viewBox="0 0 24 24" fill="none">
                        <path d="M12 2 L12 6 M12 18 L12 22 M4.93 4.93 L7.76 7.76 M16.24 16.24 L19.07 19.07 M2 12 L6 12 M18 12 L22 12 M4.93 19.07 L7.76 16.24 M16.24 7.76 L19.07 4.93" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                    </svg>
                    <span>AIÊõ¥Êñ∞Áä∂ÊÄÅ</span>
                </button>
            </div>
        </div>
    </div>

    <!-- Áõ¥Êí≠ÂºπÂπïÊµÆÂä®ÊåâÈíÆ -->
    <div class="livestream-float-btn" id="livestreamFloatBtn" style="display: none;">
        <span class="livestream-icon">üì∫</span>
        <span class="livestream-badge" id="livestreamBadge">0</span>
    </div>
    
    <!-- Áõ¥Êí≠ÂºπÂπïÈù¢Êùø -->
    <div class="livestream-panel" id="livestreamPanel" style="display: none;">
        <div class="livestream-header">
            <span class="livestream-title">üì∫ Áõ¥Êí≠Èó¥</span>
            <div class="livestream-stats">
                <span class="viewer-count">üë• <span id="viewerCount">0</span></span>
                <span class="points-display">üíé <span id="livestreamPoints">0</span></span>
            </div>
            <button class="livestream-clear" id="livestreamClear" title="Ê∏ÖÈô§ÂºπÂπï">üóëÔ∏è</button>
            <button class="livestream-close" id="livestreamClose">‚úï</button>
        </div>
        <div class="livestream-messages" id="livestreamMessages">
            <!-- ÂºπÂπïÊ∂àÊÅØ‰ºöÂú®ËøôÈáåÊòæÁ§∫ -->
        </div>
    </div>

    <!-- Chuanyue Rules Modal -->
    <div class="modal-overlay" id="chuanyueRulesModal">
        <div class="modal-box chuanyue-rules-modal">
            <div class="modal-header">
                <h3 id="rulesModalTitle">Á©øË∂äËÆæÂÆö</h3>
                <button class="modal-close" id="rulesModalClose">
                    <svg viewBox="0 0 28 28" fill="none">
                        <path d="M8 8 L20 20 M20 8 L8 20" stroke="#7a6f5f" stroke-width="2" stroke-linecap="round"/>
                    </svg>
                </button>
            </div>
            <div class="modal-body">
                <!-- Âø´Á©ø‰ªªÂä°Á±ªÂûãÈÄâÊã© -->
                <div class="form-item" id="kuaichuanTypeItem" style="display: none;">
                    <label class="form-label">‰ªªÂä°Á±ªÂûã</label>
                    <div class="kuaichuan-type-grid">
                        <button class="kuaichuan-type-btn" data-type="ganhua">
                            <div class="type-icon">üíù</div>
                            <div class="type-name">ÊÑüÂåñ</div>
                            <div class="type-desc">ÊÑüÂåñÈªëÂåñ/Â†ïËêΩÁöÑÁõÆÊ†áÔºåËÆ©ÂÖ∂ÈáçÂΩíÊ≠£ÈÄî</div>
                        </button>
                        <button class="kuaichuan-type-btn" data-type="jiushu">
                            <div class="type-icon">üåü</div>
                            <div class="type-name">ÊïëËµé</div>
                            <div class="type-desc">ÊãØÊïëÊÇ≤ÊÉ®ÂëΩËøêÁöÑÁõÆÊ†áÔºåÊîπÂèòÂÖ∂ÁªìÂ±Ä</div>
                        </button>
                        <button class="kuaichuan-type-btn" data-type="gonglue">
                            <div class="type-icon">üíï</div>
                            <div class="type-name">ÊîªÁï•</div>
                            <div class="type-desc">ÊîªÁï•ÁõÆÊ†áËßíËâ≤ÔºåËææÊàêÊÅãÁà±ÂÖ≥Á≥ª</div>
                        </button>
                        <button class="kuaichuan-type-btn" data-type="yangcheng">
                            <div class="type-icon">üå±</div>
                            <div class="type-name">ÂÖªÊàê</div>
                            <div class="type-desc">ÂüπÂÖªÁõÆÊ†áÊàêÈïøÔºåËßÅËØÅÂÖ∂ËúïÂèò</div>
                        </button>
                    </div>
                    <input type="hidden" id="kuaichuanType" value="">
                </div>
                
                <!-- Á©ø‰π¶Ê®°Âºè‰∏ìÁî®ËÆæÂÆö -->
                <div id="chuanshuSettingsGroup" style="display: none;">
                    <div class="form-item">
                        <label class="form-label">üìö ÂéüËëóÂÜÖÂÆπ</label>
                        <textarea class="form-textarea" id="chuanshuNovel" rows="4" placeholder="ÁÆÄËø∞ÂéüËëóÊïÖ‰∫ãËÉåÊôØ„ÄÅ‰∏ªË¶ÅÂâßÊÉÖ„ÄÅ‰∫∫Áâ©ÂÖ≥Á≥ªÁ≠â..."></textarea>
                    </div>
                    <div class="form-item">
                        <label class="form-label">üîÑ ËßíËâ≤ÈáçÁîüËÆæÂÆö</label>
                        <div class="chuanshu-role-select">
                            <button class="chuanshu-role-btn" data-role="none">
                                <span class="role-icon">‚ùå</span>
                                <span class="role-name">Êó†ÈáçÁîü</span>
                            </button>
                            <button class="chuanshu-role-btn" data-role="protagonist">
                                <span class="role-icon">üëë</span>
                                <span class="role-name">‰∏ªËßíÈáçÁîü</span>
                            </button>
                            <button class="chuanshu-role-btn" data-role="supporting">
                                <span class="role-icon">üé≠</span>
                                <span class="role-name">Áî∑‰∫åÈáçÁîü</span>
                            </button>
                            <button class="chuanshu-role-btn" data-role="villain">
                                <span class="role-icon">üñ§</span>
                                <span class="role-name">ÂèçÊ¥æÈáçÁîü</span>
                            </button>
                        </div>
                        <input type="hidden" id="chuanshuRebirth" value="none">
                    </div>
                    <div class="form-item">
                        <label class="form-label">üë§ Á©øË∂äË∫´‰ªΩ</label>
                        <textarea class="form-textarea" id="chuanshuIdentity" rows="3" placeholder="‰Ω†Á©øË∂äÂêéÁöÑË∫´‰ªΩÔºåÂ¶ÇÔºöÁ©øÊàê‰∫ÜÂéüËëó‰∏≠ÁöÑÁÇÆÁÅ∞Â∞èÂ¶æ„ÄÅÁ©øÊàê‰∫Ü‰∏ªËßíÁöÑÁôΩÊúàÂÖâ..."></textarea>
                    </div>
                </div>
                
                <div class="form-item" id="rulesItem">
                    <label class="form-label" id="rulesLabel">Á©øË∂äËßÑÂàô</label>
                    <textarea class="form-textarea" id="chuanyueRules" rows="4" placeholder="Â¶ÇÔºö‰∏çËÉΩÊö¥Èú≤Á©øË∂äËÄÖË∫´‰ªΩ„ÄÅÈúÄË¶ÅÂÆåÊàêÁ≥ªÁªü‰ªªÂä°„ÄÅÂèØ‰ª•‰øùÁïôÂâç‰∏ñËÆ∞ÂøÜ..."></textarea>
                </div>
                <div class="form-item" id="worldSettingsItem">
                    <label class="form-label">‰∏ñÁïåËÆæÂÆö</label>
                    <textarea class="form-textarea" id="chuanyueSettings" rows="4" placeholder="Â¶ÇÔºöÂè§‰ª£ÂÆ´Âª∑„ÄÅÁé∞‰ª£ÈÉΩÂ∏Ç„ÄÅ‰øÆ‰ªô‰∏ñÁïå„ÄÅABOËÆæÂÆö..."></textarea>
                </div>
                
                <!-- Êó†ÈôêÊµÅ‰∏ñÁïåÁ±ªÂûãÈÄâÊã© -->
                <div class="form-item" id="wuxianliuTypeItem" style="display: none;">
                    <label class="form-label">üéÆ ÂâØÊú¨Á±ªÂûã</label>
                    <div class="wuxianliu-type-grid">
                        <button class="wuxianliu-type-btn" data-type="custom">
                            <div class="type-icon">üìù</div>
                            <div class="type-name">Ëá™ÂÆö‰πâ</div>
                            <div class="type-desc">Ëá™Áî±ËÆæÂÆöÂâØÊú¨ËÉåÊôØÂíåËßÑÂàô</div>
                        </button>
                        <button class="wuxianliu-type-btn" data-type="horror">
                            <div class="type-icon">üëª</div>
                            <div class="type-name">ÊÅêÊÄñÊ±ÇÁîü</div>
                            <div class="type-desc">Ê∞õÂõ¥ÊÅêÊÄñ„ÄÅÂ§ö‰∫∫Ê±ÇÁîü„ÄÅNPC‰∫íÂä®</div>
                        </button>
                    </div>
                    <input type="hidden" id="wuxianliuType" value="custom">
                </div>
                
                <!-- Êó†ÈôêÊµÅËßíËâ≤ÊâÆÊºîËÆæÂÆö -->
                <div class="form-item" id="wuxianliuRoleItem" style="display: none;">
                    <label class="form-label">üë§ ‰Ω†ÁöÑËßíËâ≤ËÆæÂÆö</label>
                    <textarea class="form-textarea" id="wuxianliuRole" rows="4" placeholder="‰Ω†ÈúÄË¶ÅÊâÆÊºîÁöÑËßíËâ≤‰ø°ÊÅØÔºö
‚Ä¢ ÂßìÂêç„ÄÅÂπ¥ÈæÑ„ÄÅÊÄßÂà´
‚Ä¢ ÊÄßÊ†ºÁâπÁÇπÔºàÂ¶ÇÂÜ∑ÈùôÁêÜÊô∫/ÂÜ≤Âä®ÁÉ≠Ë°ÄÔºâ
‚Ä¢ ËÅå‰∏ö/Ë∫´‰ªΩËÉåÊôØ
‚Ä¢ ÁâπÊÆäËÉΩÂäõÊàñÊäÄËÉΩ
‚Ä¢ Ë°å‰∏∫ÂáÜÂàôÔºàÁ°Æ‰øù‰∏ç‰ºöOOCÔºâ"></textarea>
                    <small class="form-hint">‚ö†Ô∏è ËØ∑ËÆ§ÁúüÂ°´ÂÜôÔºåAI‰ºö‰∏•Ê†ºÊåâÁÖßËÆæÂÆöÊâÆÊºî‰Ω†ÁöÑËßíËâ≤Ôºå‰∏çÂÖÅËÆ∏OOC</small>
                </div>
                
                <!-- AI Polish Button -->
                <button class="ai-polish-btn" id="aiPolishBtn">
                    <svg viewBox="0 0 24 24" fill="none">
                        <path d="M12 2 L15 8 L22 9 L17 14 L18 21 L12 18 L6 21 L7 14 L2 9 L9 8 Z" stroke="currentColor" stroke-width="2" fill="none"/>
                    </svg>
                    <span>AI ÂÆåÂñÑ</span>
                    <small>Ê†πÊçÆ‰Ω†Â°´ÂÜôÁöÑÂÜÖÂÆπËá™Âä®Êâ©Â±ïÂÆåÂñÑ</small>
                </button>
                <div class="form-item">
                    <label class="form-label">ÊÄßÂà´ËÆæÂÆö</label>
                    <div class="gender-setting-select" id="genderSettingSelect">
                        <button class="gender-setting-btn" data-setting="keep">
                            <svg viewBox="0 0 24 24" fill="none">
                                <circle cx="12" cy="12" r="8" stroke="currentColor" stroke-width="2"/>
                                <path d="M12 8 V16 M8 12 H16" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                            </svg>
                            <span>‰øùÊåÅÂΩìÂâç</span>
                            <small>Á©øË∂äÂêé‰øùÊåÅÂéüÊúâÊÄßÂà´</small>
                        </button>
                        <button class="gender-setting-btn" data-setting="random">
                            <svg viewBox="0 0 24 24" fill="none">
                                <circle cx="8" cy="16" r="5" stroke="currentColor" stroke-width="2"/>
                                <circle cx="16" cy="8" r="5" stroke="currentColor" stroke-width="2"/>
                                <path d="M12 12 L14 10" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                            </svg>
                            <span>Ê¶ÇÁéáÂèåÊÄß</span>
                            <small>Êúâ‰∏ÄÂÆöÊ¶ÇÁéáÂèò‰∏∫ÂèåÊÄß‰ΩìË¥®</small>
                        </button>
                    </div>
                    <input type="hidden" id="genderSetting" value="keep">
                </div>
                
                <div class="form-item">
                    <label class="form-label">ÁâπÊÆäÁé©Ê≥ï</label>
                    <div class="toggle-option" id="livestreamToggle">
                        <div class="toggle-info">
                            <div class="toggle-title">üéÅ Áõ¥Êí≠ÊâìËµèÊ®°Âºè</div>
                            <div class="toggle-desc">ÂºÄÂêØÂêéÔºå‰ºöÊúâËôöÊãüËßÇ‰ºóÂÆûÊó∂ÊâìËµèÔºåÊâìËµè‰ºöËß¶ÂèëÈöèÊú∫‰∫ã‰ª∂ÂΩ±ÂìçÂâßÊÉÖ</div>
                        </div>
                        <label class="toggle-switch">
                            <input type="checkbox" id="livestreamEnabled">
                            <span class="toggle-slider"></span>
                        </label>
                    </div>
                </div>
            </div>
            <div class="modal-actions">
                <button class="modal-btn modal-btn-cancel" id="rulesModalCancel">ÂèñÊ∂à</button>
                <button class="modal-btn modal-btn-confirm" id="rulesModalConfirm">Á°ÆËÆ§ÂºÄÂßã</button>
            </div>
        </div>
    </div>

    <!-- Character Profile Modal -->
    <div class="modal-overlay" id="profileModal">
        <div class="modal-box profile-modal">
            <div class="modal-header">
                <h3 id="profileModalTitle">ÂàõÂª∫‰∫∫ËÆæ</h3>
                <button class="modal-close" id="profileModalClose">
                    <svg viewBox="0 0 28 28" fill="none">
                        <path d="M8 8 L20 20 M20 8 L8 20" stroke="#7a6f5f" stroke-width="2" stroke-linecap="round"/>
                    </svg>
                </button>
            </div>
            <div class="modal-body">
                <div class="form-row">
                    <div class="form-item form-item-half">
                        <label class="form-label">ÂêçÂ≠ó <span class="required">*</span></label>
                        <input type="text" class="form-input" id="profileName" placeholder="‰Ω†ÁöÑËßíËâ≤Âêç">
                    </div>
                    <div class="form-item form-item-half">
                        <label class="form-label">Âπ¥ÈæÑ</label>
                        <input type="number" class="form-input" id="profileAge" placeholder="Â¶ÇÔºö18" min="1" max="999">
                    </div>
                </div>
                <div class="form-item">
                    <label class="form-label">ÊÄßÂà´</label>
                    <div class="gender-select" id="genderSelect">
                        <button class="gender-btn" data-gender="male">
                            <svg viewBox="0 0 24 24" fill="none">
                                <circle cx="10" cy="14" r="6" stroke="currentColor" stroke-width="2"/>
                                <path d="M14 10 L20 4 M20 4 L20 10 M20 4 L14 4" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                            </svg>
                            <span>Áî∑</span>
                        </button>
                        <button class="gender-btn" data-gender="female">
                            <svg viewBox="0 0 24 24" fill="none">
                                <circle cx="12" cy="9" r="6" stroke="currentColor" stroke-width="2"/>
                                <path d="M12 15 V22 M9 19 H15" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                            </svg>
                            <span>Â•≥</span>
                        </button>
                        <button class="gender-btn" data-gender="other">
                            <svg viewBox="0 0 24 24" fill="none">
                                <circle cx="12" cy="12" r="6" stroke="currentColor" stroke-width="2"/>
                                <path d="M12 2 V6 M12 18 V22 M2 12 H6 M18 12 H22" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                            </svg>
                            <span>ÂÖ∂‰ªñ</span>
                        </button>
                    </div>
                    <input type="hidden" id="profileGender" value="">
                </div>
                <div class="form-item">
                    <label class="form-label">ÊÄßÊ†º</label>
                    <input type="text" class="form-input" id="profilePersonality" placeholder="Â¶ÇÔºöÊ∏©Êüî„ÄÅËÖπÈªë„ÄÅÂÇ≤Â®á...">
                </div>
                <div class="form-item">
                    <label class="form-label">ÊïèÊÑüÂ∏¶</label>
                    <input type="text" class="form-input" id="profileSensitive" placeholder="Â¶ÇÔºöËÄ≥Êúµ„ÄÅËÑñÈ¢à...">
                </div>
                <div class="form-item">
                    <label class="form-label">Â§áÊ≥®</label>
                    <textarea class="form-textarea" id="profileNotes" rows="4" placeholder="ÂÖ∂‰ªñË°•ÂÖÖ‰ø°ÊÅØÔºåÂ¶ÇÂ§ñË≤åÁâπÂæÅ„ÄÅÁâπÊÆäËÉΩÂäõ„ÄÅËÉåÊôØÊïÖ‰∫ãÁ≠â..."></textarea>
                </div>
            </div>
            <div class="modal-actions">
                <button class="modal-btn modal-btn-cancel" id="profileModalCancel">ÂèñÊ∂à</button>
                <button class="modal-btn modal-btn-confirm" id="profileModalSave">‰øùÂ≠ò</button>
            </div>
        </div>
    </div>

    <!-- Settings Modal -->
    <div class="modal-overlay" id="settingsModal">
        <div class="modal-box settings-modal">
            <div class="modal-header">
                <h3>Á≥ªÁªüËÆæÁΩÆ</h3>
                <button class="modal-close" id="settingsClose">
                    <svg viewBox="0 0 28 28" fill="none">
                        <path d="M8 8 L20 20 M20 8 L8 20" stroke="#7a6f5f" stroke-width="2" stroke-linecap="round"/>
                    </svg>
                </button>
            </div>
            
            <div class="settings-section">
                <div class="settings-title">
                    <svg viewBox="0 0 24 24" fill="none">
                        <path d="M12 2 L12 6 M12 18 L12 22 M2 12 L6 12 M18 12 L22 12" stroke="#c9a959" stroke-width="2" stroke-linecap="round"/>
                        <circle cx="12" cy="12" r="4" stroke="#c9a959" stroke-width="2"/>
                    </svg>
                    <span>API ÈÖçÁΩÆ</span>
                </div>
                
                <div class="settings-item">
                    <label class="settings-label">API ÊñπÊ°à</label>
                    <div class="input-with-btn">
                        <select class="settings-select" id="apiSchemeSelect">
                            <option value="">-- ÈÄâÊã©Â∑≤‰øùÂ≠òÊñπÊ°à --</option>
                        </select>
                        <button class="icon-btn" id="deleteScheme" title="Âà†Èô§ÊñπÊ°à">
                            <svg viewBox="0 0 24 24" fill="none">
                                <path d="M6 6 L18 18 M18 6 L6 18" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                            </svg>
                        </button>
                    </div>
                </div>
                
                <div class="settings-item">
                    <label class="settings-label">API Âú∞ÂùÄ</label>
                    <input type="text" class="settings-input" id="apiBaseUrl" placeholder="https://api.openai.com/v1">
                </div>
                
                <div class="settings-item">
                    <label class="settings-label">API ÂØÜÈí•</label>
                    <div class="input-with-btn">
                        <input type="password" class="settings-input" id="apiKey" placeholder="sk-...">
                        <button class="icon-btn" id="toggleApiKey" title="ÊòæÁ§∫/ÈöêËóè">
                            <svg viewBox="0 0 24 24" fill="none">
                                <path d="M1 12 Q12 4 23 12 Q12 20 1 12" stroke="currentColor" stroke-width="2"/>
                                <circle cx="12" cy="12" r="3" stroke="currentColor" stroke-width="2"/>
                            </svg>
                        </button>
                    </div>
                </div>
                
                <div class="settings-item">
                    <label class="settings-label">ÈÄâÊã©Ê®°Âûã</label>
                    <div class="input-with-btn">
                        <select class="settings-select" id="modelSelect">
                            <option value="">ËØ∑ÂÖàÊãâÂèñÊ®°ÂûãÂàóË°®</option>
                        </select>
                        <button class="icon-btn" id="fetchModels" title="ÊãâÂèñÊ®°Âûã">
                            <svg viewBox="0 0 24 24" fill="none">
                                <path d="M4 12 A8 8 0 1 1 12 20" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                                <path d="M4 8 L4 12 L8 12" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                            </svg>
                        </button>
                    </div>
                    <div class="fetch-status" id="fetchStatus"></div>
                </div>
                
                <div class="settings-item">
                    <div class="settings-label-row">
                        <label class="settings-label">Ê∏©Â∫¶ (Temperature)</label>
                        <span class="temperature-value" id="tempValue">0.7</span>
                    </div>
                    <div class="slider-wrapper">
                        <input type="range" class="settings-slider" id="temperatureSlider" min="0" max="2" step="0.1" value="0.7">
                        <div class="slider-labels">
                            <span>Á≤æÁ°Æ</span>
                            <span>Âπ≥Ë°°</span>
                            <span>ÂàõÊÑè</span>
                        </div>
                    </div>
                </div>
                
                <!-- Â§áÁî®APIËÆæÁΩÆ -->
                <div class="settings-divider">
                    <span>Â§áÁî®APIÔºàÁî®‰∫éÊÄªÁªì/Êï∞ÂÄºËÆ∞ÂΩïÔºåÂèØÈÄâÔºâ</span>
                </div>
                
                <div class="settings-item">
                    <label class="settings-label">Â§áÁî®APIÂú∞ÂùÄ</label>
                    <input type="text" class="settings-input" id="backupApiBaseUrl" placeholder="ÁïôÁ©∫Âàô‰ΩøÁî®‰∏ªAPI">
                </div>
                
                <div class="settings-item">
                    <label class="settings-label">Â§áÁî®APIÂØÜÈí•</label>
                    <div class="input-with-btn">
                        <input type="password" class="settings-input" id="backupApiKey" placeholder="ÁïôÁ©∫Âàô‰ΩøÁî®‰∏ªAPI">
                        <button class="icon-btn" id="toggleBackupApiKey" title="ÊòæÁ§∫/ÈöêËóè">
                            <svg viewBox="0 0 24 24" fill="none">
                                <path d="M1 12 Q12 4 23 12 Q12 20 1 12" stroke="currentColor" stroke-width="2"/>
                                <circle cx="12" cy="12" r="3" stroke="currentColor" stroke-width="2"/>
                            </svg>
                        </button>
                    </div>
                </div>
                
                <div class="settings-item">
                    <label class="settings-label">Â§áÁî®Ê®°Âûã</label>
                    <div class="input-with-btn">
                        <select class="settings-select" id="backupModelSelect">
                            <option value="">ÁïôÁ©∫Âàô‰ΩøÁî®‰∏ªÊ®°Âûã</option>
                        </select>
                        <button class="icon-btn" id="fetchBackupModels" title="ÊãâÂèñÂ§áÁî®APIÊ®°Âûã">
                            <svg viewBox="0 0 24 24" fill="none">
                                <path d="M4 12 A8 8 0 1 1 12 20" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                                <path d="M4 8 L4 12 L8 12" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                            </svg>
                        </button>
                    </div>
                    <div class="fetch-status" id="backupFetchStatus"></div>
                </div>
                
                <div class="settings-actions backup-api-actions">
                    <button class="settings-btn settings-btn-test" id="testBackupConnection">
                        <svg viewBox="0 0 24 24" fill="none">
                            <path d="M5 12 L10 17 L19 8" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                        </svg>
                        <span>Ê£ÄÊµãÂ§áÁî®API</span>
                    </button>
                </div>
                <div class="connection-status" id="backupConnectionStatus"></div>
                
                <!-- ‰∏ªÊìç‰ΩúÊåâÈíÆ -->
                <div class="settings-divider">
                    <span>Êìç‰Ωú</span>
                </div>
                
                <div class="settings-actions">
                    <button class="settings-btn settings-btn-test" id="testConnection">
                        <svg viewBox="0 0 24 24" fill="none">
                            <path d="M5 12 L10 17 L19 8" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                        </svg>
                        <span>Ê£ÄÊµã‰∏ªAPI</span>
                    </button>
                    <button class="settings-btn settings-btn-save" id="saveSettings">
                        <svg viewBox="0 0 24 24" fill="none">
                            <path d="M19 21 H5 Q3 21 3 19 V5 Q3 3 5 3 H16 L21 8 V19 Q21 21 19 21 Z" stroke="currentColor" stroke-width="2"/>
                            <path d="M7 3 V8 H15" stroke="currentColor" stroke-width="2"/>
                            <rect x="7" y="13" width="10" height="8" stroke="currentColor" stroke-width="2"/>
                        </svg>
                        <span>‰øùÂ≠òËÆæÁΩÆ</span>
                    </button>
                    <button class="settings-btn settings-btn-scheme" id="saveScheme">
                        <svg viewBox="0 0 24 24" fill="none">
                            <path d="M12 5 V19 M5 12 H19" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                        </svg>
                        <span>‰øùÂ≠òÊñπÊ°à</span>
                    </button>
                </div>
                
                <div class="connection-status" id="connectionStatus"></div>
            </div>
            
            <div class="settings-section">
                <div class="settings-title">
                    <svg viewBox="0 0 24 24" fill="none">
                        <circle cx="12" cy="12" r="10" stroke="#c9a959" stroke-width="2"/>
                        <path d="M12 2 A10 10 0 0 1 12 22" fill="#c9a959" opacity="0.3"/>
                    </svg>
                    <span>‰∏ªÈ¢òÂ§ñËßÇ</span>
                </div>
                
                <div class="settings-item">
                    <label class="settings-label">ÈÄâÊã©‰∏ªÈ¢ò</label>
                    <div class="theme-grid" id="themeGrid">
                        <div class="theme-option active" data-theme="dark-gold">
                            <div class="theme-preview dark-gold"></div>
                            <span>ÊöóÈáëÔºàÈªòËÆ§Ôºâ</span>
                        </div>
                        <div class="theme-option" data-theme="dark-purple">
                            <div class="theme-preview dark-purple"></div>
                            <span>ÊöóÁ¥´</span>
                        </div>
                        <div class="theme-option" data-theme="dark-blue">
                            <div class="theme-preview dark-blue"></div>
                            <span>ÊöóËìù</span>
                        </div>
                        <div class="theme-option" data-theme="dark-green">
                            <div class="theme-preview dark-green"></div>
                            <span>ÊöóÁªø</span>
                        </div>
                        <div class="theme-option" data-theme="light-gold">
                            <div class="theme-preview light-gold"></div>
                            <span>ÊµÖÈáë</span>
                        </div>
                        <div class="theme-option" data-theme="light-pink">
                            <div class="theme-preview light-pink"></div>
                            <span>ÊµÖÁ≤â</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Collection Modal -->
    <div class="modal-overlay" id="collectionModal">
        <div class="modal-box collection-modal">
            <div class="modal-header">
                <h3>Êî∂Ëóè‰∏éÂ≠òÊ°£</h3>
                <button class="modal-close" id="collectionModalClose">
                    <svg viewBox="0 0 28 28" fill="none">
                        <path d="M8 8 L20 20 M20 8 L8 20" stroke="#7a6f5f" stroke-width="2" stroke-linecap="round"/>
                    </svg>
                </button>
            </div>
            <div class="collection-tabs">
                <button class="collection-tab active" data-tab="favorites">Êî∂ËóèÂÜÖÂÆπ</button>
                <button class="collection-tab" data-tab="archives">‰∏ñÁïåÂ≠òÊ°£</button>
            </div>
            <div class="collection-panel active" id="favoritesPanel">
                <div class="collection-list" id="favoritesList">
                    <!-- Favorites will be added here -->
                </div>
                <div class="collection-empty" id="favoritesEmpty">
                    <span>ÊöÇÊó†Êî∂ËóèÂÜÖÂÆπ</span>
                    <small>ÈïøÊåâËÅäÂ§©Ê∂àÊÅØÂèØÊî∂Ëóè</small>
                </div>
            </div>
            <div class="collection-panel" id="archivesPanel">
                <div class="collection-list" id="archivesList">
                    <!-- Archives will be added here -->
                </div>
                <div class="collection-empty" id="archivesEmpty">
                    <span>ÊöÇÊó†‰∏ñÁïåÂ≠òÊ°£</span>
                    <small>Âú®Ê∏∏Êàè‰∏≠ÁÇπÂáªÂ≠òÊ°£ÊåâÈíÆ‰øùÂ≠ò</small>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Favorite Detail Modal -->
    <div class="modal-overlay" id="favoriteDetailModal">
        <div class="modal-box favorite-detail-modal">
            <div class="modal-header">
                <button class="modal-back" id="favoriteDetailBack">
                    <svg viewBox="0 0 24 24" fill="none">
                        <path d="M15 18 L9 12 L15 6" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                    </svg>
                </button>
                <h3 id="favoriteDetailTitle">Êî∂ËóèËØ¶ÊÉÖ</h3>
                <button class="modal-close" id="favoriteDetailClose">
                    <svg viewBox="0 0 28 28" fill="none">
                        <path d="M8 8 L20 20 M20 8 L8 20" stroke="#7a6f5f" stroke-width="2" stroke-linecap="round"/>
                    </svg>
                </button>
            </div>
            <div class="favorite-detail-content" id="favoriteDetailContent">
                <!-- Content will be shown here -->
            </div>
            <div class="favorite-detail-meta" id="favoriteDetailMeta">
                <!-- Meta info -->
            </div>
            <div class="favorite-detail-actions">
                <button class="favorite-action-btn" id="favoriteCopyBtn">
                    <svg viewBox="0 0 24 24" fill="none">
                        <rect x="9" y="9" width="13" height="13" rx="2" stroke="currentColor" stroke-width="2"/>
                        <path d="M5 15 H4 Q2 15 2 13 V4 Q2 2 4 2 H13 Q15 2 15 4 V5" stroke="currentColor" stroke-width="2"/>
                    </svg>
                    <span>Â§çÂà∂ÂÜÖÂÆπ</span>
                </button>
                <button class="favorite-action-btn delete" id="favoriteDeleteBtn">
                    <svg viewBox="0 0 24 24" fill="none">
                        <path d="M3 6 H21 M8 6 V4 a2 2 0 0 1 2-2 h4 a2 2 0 0 1 2 2 v2 M19 6 v14 a2 2 0 0 1-2 2 H7 a2 2 0 0 1-2-2 V6" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                    </svg>
                    <span>Âà†Èô§Êî∂Ëóè</span>
                </button>
            </div>
        </div>
    </div>

    <!-- Shop Modal -->
    <div class="modal-overlay" id="shopModal">
        <div class="modal-box shop-modal">
            <div class="modal-header">
                <h3>üõí Á≥ªÁªüÂïÜÂüé</h3>
                <div class="shop-modal-points">
                    <span class="points-icon">üíé</span>
                    <span id="shopModalPoints">0</span> ÁßØÂàÜ
                </div>
                <button class="modal-close" id="shopModalClose">
                    <svg viewBox="0 0 28 28" fill="none">
                        <path d="M8 8 L20 20 M20 8 L8 20" stroke="#7a6f5f" stroke-width="2" stroke-linecap="round"/>
                    </svg>
                </button>
            </div>
            <div class="modal-body">
                <div class="shop-items" id="shopItems">
                    <div class="shop-loading">Ê≠£Âú®Âä†ËΩΩÂïÜÂìÅ...</div>
                </div>
            </div>
            <div class="modal-actions">
                <button class="modal-btn modal-btn-cancel" id="refreshShopBtn">
                    <svg viewBox="0 0 24 24" fill="none" style="width:16px;height:16px;margin-right:4px;">
                        <path d="M1 4 V10 H7 M23 20 V14 H17" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                        <path d="M3.51 9 A9 9 0 0 1 18.36 5.64 L23 10 M1 14 L5.64 18.36 A9 9 0 0 0 20.49 15" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                    </svg>
                    Âà∑Êñ∞ÂïÜÂìÅ
                </button>
                <button class="modal-btn modal-btn-confirm" id="shopModalConfirm">ÂÖ≥Èó≠</button>
            </div>
        </div>
    </div>

    <script src="script.js"></script>
</body>
</html>
